##### 分布式系统的CAP理论

C: consistency 一致性, 要求各个节点每时每刻都保持数据一致

A: Avalibility 可用性, 系统要求一直能够提供正常有效的服务

P: Partition Tolerance 分区容错性, 某个节点出现错误时, 整个系统仍然能对外正常提供服务

***P*** 是一定要满足的, 因为如果某个节点除了故障系统就瘫痪, 那么整这个分布式还有什么意义, 还不如直接单机运行

而且, CAP不同三个同时满足, 因此就必须从 C 或者 A 中舍弃一点





##### zookeeper 

​	用于存放分布式系统中的共享数据, 它主要是用来解决分布式应用中经常遇到的一些数据管理问题，如：统一命名服务、状态同步服务、集群管理、分布式应用配置项的管理等

​	zookeeper满足的是CP, 不能确保总是可以正常访问, 但是保证数据绝对给你整对了

​	zookeeper学术上来说是 ***分布式协调系统*** , 以集群的方式给分布式系统提供统一的数据服务, 而且要从外边看像是一台单机, 它的优势就在于能够很快地完成数据的同步, 作为一个成熟的程序, 其他框架也就不自己再造轮子, 直接就使用zk, 因此zk才会流行起来





###### 读写分离?

​	分为leader, fllower, observer节点, 只有leader执行写操作, 其他节点提供读服务

###### session?

​	客户端与服务端建立连接时创建session, 定时心跳检测连接状态, 并且客户端可以watch节点变换, 当对应节点发生变化时, 服务端通知客户端, 然后客户端再读取新的值

###### 临时与永久节点?

​	可以选择创建临时或者永久节点, 临时节点在断开session连接时就自动删除

###### 节点存储?

​	数据节点按照文件的组织方式存储, /xxx/yyy/zzz

###### 数据发布与订阅?

​	发布者在指定节点添加信息, 订阅者watch这些节点实时获取到最新信息

###### 命名管理?

​	可以用作分布式命名管理系统, 使用自增值的节点作为分布式数据库记录的id, 可保证分布式数据库系统id不重复

###### 监听机制?

​	与zookeeper建立连接的会话可以选择监听感兴趣的节点的事件, 当发生这些事件时, 会话收到通知

###### 分布式锁?

​	请求临界数据时向zookeeper中添加临时编号节点, 然后检查是否为当前最小节点, 是则认为拿到了锁, 否则监听前一个编号节点的删除事件, 直至收到通知, 才代表获得了锁

###### 注册中心?

​	生产者在上面注册节点, 消费者从上面查看可用节点进行访问

###### 配置中心?

​	将分布式服务要用到的公共配置放到其节点上, 各个服务从上面取配置使用, 这样在配置需要修改时只需要修改zookeeper上的节点值即可